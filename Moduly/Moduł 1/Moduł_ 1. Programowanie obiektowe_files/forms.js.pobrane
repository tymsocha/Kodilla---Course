App.Views.AjaxForm=Backbone.View.extend({events:function(){return{submit:"submit"}},initialize:function(a){this.$notifications=$(".alert"),this.prepareTagsInput(),this.loader=$("#preloader").eq(0)},showErrors:function(a){App.alertsView.showErrors(a)},showSuccess:function(a){a.redirect&&delete a.redirect,App.alertsView.showSuccess(a)},submit:function(a){var b=this;a.preventDefault(),this.loader.length&&this.loader.show(),b.$notifications.hide();var c=this.$el.data("event"),d=$.extend(_.object(_.map(this.$el.serializeArray(),_.values)),(this.data||$.noop).call(this)),e=$(a.currentTarget).find('[data-role="submit-button"]');return e.length&&e.attr("disabled","disabled").find('[data-role="loading-icon"]').removeClass("display-none"),$.ajax(this.$el.attr("action"),$.extend({type:this.$el.attr("method")||"POST",data:d,dataType:"json"},(this.ajaxOptions||$.noop).call(this))).done(function(a){b.loader.length&&b.loader.hide(),b.trackGoogleAnalyticsEvent(d),c&&analytics.track(c+"_valid"),"auth_login"===c&&dataLayer.push({event:"login",userID:a.id}),a&&a.redirect&&window.location.replace(a.redirect),a&&a.message&&b.showSuccess(a)}).fail(function(a){b.loader.length&&b.loader.hide(),e.length&&e.removeAttr("disabled").find('[data-role="loading-icon"]').addClass("display-none"),c&&analytics.track(c+"_invalid"),a.redirect&&window.location.replace(a.redirect),422!==a.status&&403!==a.status||b.showErrors(a.responseJSON)}),!1},trackGoogleAnalyticsEvent:function(a){for(var b in a){var c=b.split("ga-")[1];c&&"dev"!==window.environment&&(dataLayer.push({event:c}),ga("send","event",c,a[b]))}},prepareTagsInput:function(){var a=this.$('input[data-role="tagsinput"]');a.length&&(a.tagsinput(),a.prev().find("input").keypress(function(a){13==a.keyCode&&a.preventDefault()}))}}),App.Views.NextVideoCallForm=App.Views.AjaxForm.extend({currentDateTime:"",initialize:function(){this._super();var a=this.$el.find('input[name="next_call_at"]'),b=a.data("position");this.currentDateTime=a.val(),a.datetimepicker({icons:{time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-arrow-up",down:"fa fa-arrow-down",next:"fa fa-arrow-right",previous:"fa fa-arrow-left"},format:"YYYY-MM-DD HH:mm",widgetPositioning:{vertical:b}}).on("dp.hide",$.proxy(this.save,this))},save:function(){this.$el.submit()},showErrors:function(a){this._super(a),this.$el.find('input[name="next_call_at"]').val(this.currentDateTime)},showSuccess:function(a){this._super(a),this.currentDateTime=this.$el.find('input[name="next_call_at"]').val()}}),App.Views.AcceptNewTosForm=App.Views.AjaxForm.extend({showSuccess:function(a){this._super(a),this.$el.closest("section").remove()}}),App.Views.BootcampMailForm=App.Views.AjaxForm.extend({showSuccess:function(a){this._super(a),this.$('input[type="text"], textarea').val("")}}),App.Views.BootcampRegisterForm=App.Views.AjaxForm.extend({submit:function(a){this.$("button").prop("disabled",!0),this._super(a)},showSuccess:function(a){this._super(a),analytics.track("bootcamp_modal_send")},showErrors:function(a){this._super(a),this.$("button").prop("disabled",!1)}}),App.Views.InformatorForm=App.Views.AjaxForm.extend({submit:function(a){this.$("button").prop("disabled",!0).find('[data-role="loading-icon"]').removeClass("display-none"),this._super(a)},showSuccess:function(a){this.$el.parent().find("h3, h4, form, .modal-footer").toggleClass("display-none"),App.alertsView.showSuccess({dontShowAlert:!0}),$('[data-target="#collapsingNavbar"]').click(),analytics.track("bootcamp_modal_send"),window.trackingActivitiesService.checkIfUserHasConversations(),window.trackingActivitiesService.checkIfUserHasCallData()},showErrors:function(a){this._super(a),this.$("button").prop("disabled",!1)}}),App.Views.RegisterForm=App.Views.AjaxForm.extend({data:function(){var a=localStorage.getItem("lead_id");return a?{lead_id:a}:{}}});